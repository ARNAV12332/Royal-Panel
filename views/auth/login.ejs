<!DOCTYPE html>
<html class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= name %> - Login</title>
    <link href="../assets/tailwind.css" rel="stylesheet" />
    <style>
      .glass {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border-radius: 16px;
      }
    </style>
  </head>
  <body
    class="h-full font-sans"
    style="
      background-image: url('https://4kwallpapers.com/images/wallpapers/minecraft-game-3840x2160-16737.jpg');
      background-size: cover;
      background-position: center;
    "
  >
    <div class="min-h-full flex items-center justify-center px-4 py-12">
      <div class="glass w-full max-w-md p-8">
        <div class="text-center">
          <% if (logo == true) { %><img
            class="h-14 w-auto mx-auto"
            src="../assets/logo.png"
          /><% } %>
          <h2 class="mt-6 text-3xl font-semibold text-white">
            Sign in to <%= name %>
          </h2>
          <p class="mt-2 text-sm text-white/80">
            Please enter your account credentials below.
          </p>
        </div>
        <form
          id="login-form"
          class="mt-8 space-y-6"
          onsubmit="event.preventDefault(); submitForm();"
        >
          <div>
            <label class="block text-sm text-white/70">Username or Email</label>
            <input
              id="username"
              required
              autocomplete="username"
              placeholder="example"
              class="w-full mt-2 px-3 py-2 rounded-xl text-white bg-white/20 focus:outline-none"
            />
          </div>
          <div>
            <label class="block text-sm text-white/70">Password</label>
            <input
              id="password"
              type="password"
              required
              autocomplete="current-password"
              placeholder="********"
              class="w-full mt-2 px-3 py-2 rounded-xl text-white bg-white/20 focus:outline-none"
            />
          </div>
          <div class="flex items-center justify-between text-sm text-white/70">
            <label class="flex items-center gap-2">
              <input
                id="remember-me"
                type="checkbox"
                class="h-4 w-4 bg-white/20 rounded"
              />
              Remember me
            </label>
            <a href="/auth/reset-password" class="hover:text-white"
              >Forgot password?</a
            >
          </div>
          <button
            type="button"
            onclick="submitForm()"
            class="w-full py-2 mt-4 rounded-xl bg-white/80 text-neutral-900 font-medium hover:bg-white/90 transition"
            style="border: 1px solid black"
          >
            Sign in
          </button>
          <p class="mt-4 text-center text-sm text-white/70">
            Need an account?
            <a href="/register" class="hover:text-white">Register</a>
          </p>

          <!-- Error / status messages -->
          <% if (req.query.err && req.query.err == "InvalidCredentials") { %>
          <p class="text-amber-600 text-sm mt-2">
            Invalid credentials. Please try again.
          </p>
          <% } %>
          <!-- (rest of your message handling stays same) -->
        </form>
      </div>
    </div>

    <script>
      document
        .getElementById("login-form")
        .addEventListener("keypress", function (event) {
          if (event.key === "Enter") {
            event.preventDefault();
            let u = document.getElementById("username").value.trim();
            let p = document.getElementById("password").value.trim();
            if (u !== "" && p === "") {
              document.getElementById("password").focus();
            } else {
              submitForm();
            }
          }
        });
      async function submitForm() {
        let u = document.getElementById("username").value.trim();
        let p = document.getElementById("password").value.trim();
        if (u === "" || p === "") {
          document.location.href = `/auth/login?err=InvalidCredentials&state=failed`;
          return;
        }
        document.location.href = `/auth/login?username=${encodeURIComponent(
          u
        )}&password=${encodeURIComponent(p)}`;
      }
    </script>
  </body>
</html>
